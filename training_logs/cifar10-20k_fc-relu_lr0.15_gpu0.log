/egr/research-slim/ghoshavr/edge-of-stability/src/utilities.py:242: UserWarning: torch.linalg.svd: During SVD computation with the selected cusolver driver, batches 0 failed to converge. A more accurate method will be used to compute the SVD as a fallback. Check doc at https://pytorch.org/docs/stable/generated/torch.linalg.svd.html (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541035/work/aten/src/ATen/native/cuda/linalg/BatchLinearAlgebraLib.cpp:869.)
  u, s, v = torch.svd(layer.weight.data)
device: cuda:0
output directory: RESULTS/cifar10-20k/fc-relu/seed_0/mse/gd//lr_0.15
Files already downloaded and verified
Files already downloaded and verified
eigenvalues:  tensor([15.4596, 14.0058])
0	0.519	0.084	0.518	0.090
10	0.405	0.348	0.406	0.340
20	0.391	0.384	0.394	0.375
30	0.381	0.411	0.386	0.394
40	0.374	0.431	0.381	0.409
50	0.367	0.449	0.376	0.423
60	0.365	0.457	0.376	0.424
70	0.359	0.471	0.371	0.430
80	0.355	0.481	0.369	0.438
90	0.351	0.490	0.367	0.443
eigenvalues:  tensor([15.5871, 14.3705])
100	0.351	0.488	0.368	0.437
110	0.345	0.505	0.363	0.449
120	0.351	0.496	0.370	0.439
130	0.341	0.513	0.363	0.449
140	0.341	0.512	0.363	0.446
150	0.338	0.520	0.362	0.451
160	0.337	0.520	0.362	0.449
170	0.335	0.532	0.361	0.456
180	0.334	0.528	0.361	0.452
190	0.330	0.535	0.358	0.459
eigenvalues:  tensor([16.0413, 14.7912])
200	0.329	0.538	0.358	0.460
210	0.329	0.538	0.359	0.459
220	0.327	0.541	0.358	0.461
230	0.324	0.555	0.357	0.465
240	0.327	0.546	0.360	0.459
250	0.320	0.553	0.356	0.459
260	0.319	0.566	0.357	0.464
270	0.318	0.565	0.357	0.465
280	0.323	0.546	0.361	0.456
290	0.321	0.561	0.360	0.457
eigenvalues:  tensor([15.6899, 15.1925])
300	0.314	0.577	0.356	0.468
310	0.312	0.582	0.356	0.471
320	0.310	0.587	0.353	0.474
330	0.310	0.593	0.355	0.472
340	0.312	0.588	0.359	0.461
350	0.308	0.592	0.356	0.465
360	0.304	0.595	0.354	0.470
370	0.315	0.587	0.365	0.459
380	0.302	0.601	0.355	0.469
390	0.304	0.606	0.357	0.471
eigenvalues:  tensor([16.7649, 16.3959])
400	0.304	0.602	0.360	0.466
410	0.302	0.615	0.356	0.467
420	0.297	0.626	0.353	0.479
430	0.297	0.617	0.354	0.472
440	0.299	0.616	0.357	0.472
450	0.299	0.612	0.359	0.462
460	0.290	0.637	0.351	0.483
470	0.297	0.619	0.359	0.467
480	0.287	0.639	0.352	0.483
490	0.300	0.621	0.363	0.466
eigenvalues:  tensor([19.3720, 17.5266])
500	0.309	0.597	0.371	0.458
510	0.285	0.655	0.351	0.480
520	0.292	0.635	0.359	0.475
530	0.283	0.647	0.352	0.477
540	0.298	0.618	0.367	0.461
550	0.290	0.646	0.360	0.471
560	0.288	0.645	0.361	0.466
570	0.290	0.639	0.364	0.454
580	0.281	0.657	0.355	0.475
590	0.279	0.668	0.356	0.474
eigenvalues:  tensor([18.7505, 17.5974])
600	0.283	0.652	0.360	0.467
610	0.280	0.661	0.359	0.472
620	0.274	0.669	0.354	0.472
630	0.278	0.662	0.361	0.471
640	0.278	0.662	0.361	0.468
650	0.272	0.672	0.354	0.481
660	0.267	0.695	0.351	0.485
670	0.271	0.689	0.356	0.478
680	0.271	0.684	0.357	0.474
690	0.268	0.685	0.355	0.480
eigenvalues:  tensor([17.5915, 16.7573])
700	0.270	0.677	0.357	0.481
710	0.272	0.685	0.361	0.474
720	0.266	0.688	0.356	0.483
730	0.266	0.690	0.359	0.472
740	0.261	0.702	0.355	0.479
750	0.266	0.692	0.359	0.480
760	0.270	0.683	0.361	0.476
770	0.276	0.668	0.369	0.466
780	0.271	0.684	0.366	0.468
790	0.257	0.711	0.357	0.480
eigenvalues:  tensor([18.7997, 17.3333])
800	0.275	0.685	0.375	0.451
810	0.261	0.701	0.362	0.475
820	0.256	0.715	0.356	0.481
830	0.256	0.712	0.357	0.482
840	0.253	0.717	0.357	0.482
850	0.254	0.713	0.358	0.482
860	0.250	0.744	0.352	0.490
870	0.253	0.726	0.358	0.481
880	0.254	0.721	0.362	0.477
890	0.252	0.732	0.360	0.480
eigenvalues:  tensor([19.1418, 16.7067])
900	0.254	0.722	0.364	0.474
910	0.251	0.725	0.362	0.473
920	0.251	0.732	0.364	0.474
930	0.272	0.692	0.385	0.445
940	0.248	0.728	0.362	0.480
950	0.245	0.733	0.361	0.477
960	0.247	0.740	0.363	0.483
970	0.235	0.768	0.354	0.491
980	0.247	0.743	0.366	0.475
990	0.235	0.755	0.356	0.493
eigenvalues:  tensor([17.9116, 16.0479])
1000	0.249	0.742	0.366	0.469
1010	0.247	0.739	0.370	0.471
1020	0.245	0.729	0.367	0.482
1030	0.243	0.739	0.367	0.470
1040	0.242	0.751	0.367	0.471
1050	0.241	0.739	0.366	0.475
1060	0.228	0.779	0.355	0.483
1070	0.233	0.770	0.362	0.481
1080	0.231	0.769	0.362	0.483
1090	0.237	0.751	0.364	0.479
eigenvalues:  tensor([21.0676, 18.2365])
1100	0.236	0.758	0.366	0.482
1110	0.235	0.756	0.368	0.476
1120	0.235	0.757	0.366	0.485
1130	0.234	0.769	0.367	0.470
1140	0.224	0.776	0.359	0.489
1150	0.233	0.763	0.369	0.484
1160	0.241	0.750	0.376	0.463
1170	0.227	0.775	0.364	0.479
1180	0.227	0.786	0.364	0.475
1190	0.240	0.758	0.379	0.456
eigenvalues:  tensor([20.8454, 19.2328])
1200	0.242	0.749	0.378	0.456
1210	0.219	0.800	0.358	0.489
1220	0.232	0.774	0.371	0.464
1230	0.235	0.756	0.372	0.478
1240	0.224	0.783	0.368	0.475
1250	0.232	0.758	0.374	0.474
1260	0.224	0.778	0.369	0.480
1270	0.222	0.788	0.367	0.483
1280	0.220	0.788	0.368	0.482
1290	0.219	0.794	0.370	0.475
eigenvalues:  tensor([22.3224, 20.8727])
1300	0.224	0.784	0.375	0.480
1310	0.220	0.782	0.369	0.482
1320	0.222	0.787	0.369	0.476
1330	0.222	0.779	0.373	0.480
1340	0.219	0.795	0.371	0.469
1350	0.218	0.794	0.374	0.470
1360	0.224	0.777	0.376	0.468
1370	0.205	0.819	0.364	0.485
1380	0.207	0.810	0.366	0.486
1390	0.220	0.794	0.378	0.462
eigenvalues:  tensor([23.0858, 20.5160])
1400	0.237	0.757	0.387	0.457
1410	0.207	0.830	0.366	0.474
1420	0.205	0.818	0.365	0.484
1430	0.210	0.802	0.369	0.479
1440	0.212	0.805	0.374	0.461
1450	0.213	0.811	0.373	0.468
1460	0.219	0.793	0.378	0.481
1470	0.202	0.823	0.368	0.481
1480	0.208	0.814	0.371	0.476
1490	0.204	0.827	0.369	0.483
eigenvalues:  tensor([20.3917, 18.3514])
1500	0.199	0.838	0.370	0.474
1510	0.212	0.809	0.379	0.469
1520	0.208	0.809	0.375	0.479
1530	0.200	0.822	0.374	0.486
1540	0.201	0.826	0.373	0.476
1550	0.196	0.847	0.365	0.481
1560	0.201	0.827	0.374	0.468
1570	0.212	0.805	0.381	0.464
1580	0.200	0.834	0.375	0.465
1590	0.199	0.839	0.374	0.466
eigenvalues:  tensor([20.6622, 17.5859])
1600	0.198	0.835	0.377	0.478
1610	0.204	0.822	0.384	0.461
1620	0.199	0.832	0.377	0.469
1630	0.203	0.817	0.383	0.462
1640	0.212	0.803	0.383	0.463
1650	0.195	0.846	0.371	0.476
1660	0.197	0.833	0.375	0.479
1670	0.196	0.838	0.375	0.473
1680	0.191	0.836	0.376	0.475
1690	0.194	0.845	0.376	0.470
eigenvalues:  tensor([20.8396, 17.7720])
1700	0.207	0.811	0.388	0.465
1710	0.192	0.848	0.379	0.468
1720	0.191	0.842	0.377	0.477
1730	0.189	0.856	0.378	0.466
1740	0.191	0.841	0.379	0.477
1750	0.185	0.861	0.377	0.467
1760	0.179	0.870	0.370	0.487
1770	0.184	0.861	0.378	0.477
1780	0.180	0.872	0.373	0.475
1790	0.207	0.809	0.391	0.446
eigenvalues:  tensor([23.8965, 21.9223])
1800	0.203	0.828	0.389	0.452
1810	0.190	0.855	0.383	0.458
1820	0.182	0.865	0.373	0.472
1830	0.197	0.832	0.385	0.458
1840	0.188	0.839	0.379	0.480
1850	0.182	0.857	0.380	0.475
1860	0.207	0.812	0.398	0.453
1870	0.195	0.827	0.386	0.473
1880	0.187	0.846	0.383	0.464
1890	0.182	0.870	0.379	0.471
eigenvalues:  tensor([21.3867, 18.6877])
1900	0.173	0.884	0.376	0.472
1910	0.203	0.816	0.401	0.458
1920	0.193	0.843	0.395	0.458
1930	0.202	0.815	0.403	0.461
1940	0.194	0.823	0.391	0.464
1950	0.170	0.885	0.374	0.479
1960	0.189	0.842	0.393	0.455
1970	0.184	0.852	0.384	0.465
1980	0.189	0.852	0.393	0.453
1990	0.167	0.884	0.374	0.483
eigenvalues:  tensor([21.2539, 20.3913])
2000	0.175	0.867	0.387	0.465
2010	0.174	0.874	0.383	0.472
2020	0.183	0.855	0.387	0.477
2030	0.183	0.859	0.394	0.462
2040	0.175	0.875	0.382	0.468
2050	0.190	0.837	0.398	0.449
2060	0.174	0.876	0.388	0.466
2070	0.164	0.891	0.377	0.475
2080	0.179	0.856	0.394	0.461
2090	0.185	0.845	0.393	0.464
eigenvalues:  tensor([27.4320, 20.9568])
2100	0.173	0.872	0.386	0.474
2110	0.173	0.859	0.387	0.471
2120	0.169	0.888	0.376	0.479
2130	0.171	0.877	0.390	0.470
2140	0.175	0.869	0.394	0.473
2150	0.160	0.887	0.378	0.482
2160	0.164	0.888	0.388	0.471
2170	0.169	0.874	0.393	0.470
2180	0.158	0.902	0.383	0.474
2190	0.167	0.879	0.390	0.472
eigenvalues:  tensor([18.9827, 16.3159])
2200	0.167	0.895	0.379	0.470
2210	0.163	0.897	0.385	0.472
2220	0.161	0.896	0.385	0.477
2230	0.167	0.876	0.398	0.468
2240	0.158	0.896	0.386	0.478
2250	0.168	0.884	0.391	0.470
2260	0.174	0.865	0.397	0.464
2270	0.177	0.859	0.400	0.461
2280	0.161	0.890	0.388	0.474
2290	0.152	0.904	0.382	0.487
eigenvalues:  tensor([21.7100, 20.3348])
2300	0.164	0.885	0.397	0.467
2310	0.158	0.896	0.383	0.474
2320	0.156	0.901	0.387	0.474
2330	0.168	0.874	0.393	0.463
2340	0.148	0.916	0.386	0.478
2350	0.170	0.871	0.402	0.459
2360	0.168	0.890	0.389	0.453
2370	0.153	0.903	0.391	0.473
2380	0.169	0.878	0.394	0.455
2390	0.157	0.909	0.386	0.466
eigenvalues:  tensor([22.7576, 18.5056])
2400	0.151	0.904	0.384	0.475
2410	0.175	0.867	0.403	0.453
2420	0.156	0.899	0.389	0.466
2430	0.151	0.904	0.389	0.473
2440	0.166	0.878	0.403	0.463
2450	0.161	0.886	0.403	0.457
2460	0.153	0.911	0.387	0.457
2470	0.158	0.890	0.398	0.456
2480	0.150	0.911	0.388	0.459
2490	0.153	0.905	0.394	0.465
eigenvalues:  tensor([26.7849, 25.8265])
2500	0.168	0.877	0.404	0.443
2510	0.163	0.898	0.379	0.471
2520	0.152	0.914	0.392	0.454
2530	0.158	0.905	0.400	0.457
2540	0.159	0.894	0.403	0.450
2550	0.158	0.889	0.400	0.461
2560	0.149	0.906	0.392	0.472
2570	0.140	0.927	0.382	0.476
2580	0.175	0.860	0.417	0.439
2590	0.153	0.912	0.395	0.460
eigenvalues:  tensor([23.4082, 23.0192])
2600	0.154	0.898	0.402	0.469
2610	0.155	0.897	0.391	0.470
2620	0.159	0.892	0.405	0.452
2630	0.156	0.906	0.395	0.458
2640	0.146	0.921	0.396	0.463
2650	0.141	0.922	0.392	0.463
2660	0.190	0.836	0.425	0.435
2670	0.503	0.681	0.692	0.369
Traceback (most recent call last):
  File "src/gd.py", line 126, in <module>
    seed=args.seed,device_id=args.device_id)
  File "src/gd.py", line 58, in main
    store_singular_values(network, singular_value_storage)
  File "/egr/research-slim/ghoshavr/edge-of-stability/src/utilities.py", line 242, in store_singular_values
    u, s, v = torch.svd(layer.weight.data)
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 199).
