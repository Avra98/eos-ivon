/egr/research-slim/ghoshavr/edge-of-stability/src/cifar.py:79: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(mnist_train.targets)
/egr/research-slim/ghoshavr/edge-of-stability/src/cifar.py:80: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test = torch.tensor(mnist_test.targets)
/egr/research-slim/ghoshavr/edge-of-stability/src/utilities.py:242: UserWarning: torch.linalg.svd: During SVD computation with the selected cusolver driver, batches 0 failed to converge. A more accurate method will be used to compute the SVD as a fallback. Check doc at https://pytorch.org/docs/stable/generated/torch.linalg.svd.html (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541035/work/aten/src/ATen/native/cuda/linalg/BatchLinearAlgebraLib.cpp:869.)
  u, s, v = torch.svd(layer.weight.data)
device: cuda:2
output directory: RESULTS/mnist-1k/fc-relu-depth4/seed_0/mse/gd//lr_2.0
eigenvalues:  tensor([1.5447, 1.4789])
0	0.509	0.094	0.509	0.096
10	0.853	0.094	0.851	0.096
20	0.857	0.094	0.856	0.096
30	0.860	0.094	0.859	0.096
40	0.864	0.094	0.863	0.096
50	0.871	0.094	0.870	0.096
60	0.884	0.094	0.883	0.096
70	0.899	0.094	0.898	0.096
80	0.996	0.094	0.996	0.096
90	1.130	0.094	1.128	0.096
eigenvalues:  tensor([1.0004, 1.0000])
100	1.132	0.094	1.130	0.096
110	1.138	0.094	1.136	0.096
120	1.195	0.098	1.193	0.099
Traceback (most recent call last):
  File "src/gd.py", line 126, in <module>
    seed=args.seed,device_id=args.device_id)
  File "src/gd.py", line 58, in main
    store_singular_values(network, singular_value_storage)
  File "/egr/research-slim/ghoshavr/edge-of-stability/src/utilities.py", line 242, in store_singular_values
    u, s, v = torch.svd(layer.weight.data)
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 199).
